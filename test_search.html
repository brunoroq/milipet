<!-- Test de bÃºsqueda MiliPet -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test BÃºsqueda - MiliPet</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .test-case { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .test-case h3 { margin: 0 0 10px 0; color: #2E6B30; }
        .test-case code { background: #fff; padding: 2px 6px; border-radius: 4px; }
        .result { margin-top: 10px; }
        .success { color: #2E6B30; font-weight: bold; }
        .fail { color: #c62828; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ¾ Test de BÃºsqueda MiliPet</h1>
    <p>Prueba estos casos para verificar que la bÃºsqueda funciona correctamente:</p>

    <div class="test-case">
        <h3>Test 1: BÃºsqueda case-insensitive bÃ¡sica</h3>
        <p>Buscar: <code>xd</code> â†’ Debe encontrar: <code>XDXDDD</code></p>
    <a href="public/?r=catalog&q=xd" target="_blank">ğŸ”— Probar bÃºsqueda "xd"</a>
    </div>

    <div class="test-case">
        <h3>Test 2: BÃºsqueda inversa</h3>
        <p>Buscar: <code>XDXDDD</code> â†’ Debe encontrar: <code>xd</code> o <code>XDXDDD</code></p>
    <a href="public/?r=catalog&q=XDXDDD" target="_blank">ğŸ”— Probar bÃºsqueda "XDXDDD"</a>
    </div>

    <div class="test-case">
        <h3>Test 3: BÃºsqueda parcial</h3>
        <p>Buscar: <code>ali</code> â†’ Debe encontrar: <code>Alimento</code>, <code>ALIMENTO Premium</code>, etc.</p>
    <a href="public/?r=catalog&q=ali" target="_blank">ğŸ”— Probar bÃºsqueda "ali"</a>
    </div>

    <div class="test-case">
        <h3>Test 4: BÃºsqueda con mayÃºsculas</h3>
        <p>Buscar: <code>ALIMENTO</code> â†’ Debe encontrar: <code>alimento</code>, <code>Alimento Premium</code>, etc.</p>
    <a href="public/?r=catalog&q=ALIMENTO" target="_blank">ğŸ”— Probar bÃºsqueda "ALIMENTO"</a>
    </div>

    <div class="test-case">
        <h3>Test 5: BÃºsqueda vacÃ­a</h3>
        <p>No buscar nada â†’ Debe mostrar todos los productos activos</p>
    <a href="public/?r=catalog" target="_blank">ğŸ”— Probar catÃ¡logo sin filtros</a>
    </div>

    <div class="test-case">
        <h3>Test 6: Sin resultados</h3>
        <p>Buscar: <code>xyz123abc</code> â†’ Debe mostrar mensaje "No se encontraron resultados" + sugerencias</p>
    <a href="public/?r=catalog&q=xyz123abc" target="_blank">ğŸ”— Probar bÃºsqueda sin resultados</a>
    </div>

    <div class="test-case">
        <h3>Test 7: BÃºsqueda + filtro categorÃ­a</h3>
        <p>Buscar: <code>collar</code> + CategorÃ­a â†’ Debe filtrar correctamente</p>
    <a href="public/?r=catalog&q=collar&cid=2" target="_blank">ğŸ”— Probar bÃºsqueda con filtros</a>
    </div>

    <hr style="margin: 30px 0;">
    
    <h2>ğŸ“‹ Checklist de validaciÃ³n:</h2>
    <ul>
        <li>âœ… "xd" encuentra "XDXDDD" (case-insensitive)</li>
        <li>âœ… "XDXDDD" encuentra productos con esas letras</li>
        <li>âœ… BÃºsqueda parcial funciona (coincidencias en medio)</li>
        <li>âœ… Sin resultados muestra mensaje + sugerencias</li>
        <li>âœ… Filtros vacÃ­os ("", "0") son ignorados</li>
        <li>âœ… No hay errores SQL de parÃ¡metros</li>
        <li>âœ… Input mantiene el texto buscado</li>
        <li>âœ… BotÃ³n "Limpiar filtros" aparece cuando hay filtros</li>
    </ul>

    <h2>ğŸ” Verificar logs (desarrollo):</h2>
    <p>En localhost, revisa los logs de PHP para ver:</p>
    <pre style="background: #333; color: #0f0; padding: 15px; border-radius: 8px; overflow-x: auto;">
[SEARCH SQL] ... AND (LOWER(p.name) LIKE LOWER(:q) OR LOWER(p.description) LIKE LOWER(:q)) ...
[SEARCH PARAMS] {":q":"%xd%"}
    </pre>
    
    <h2>âœ… MÃ©todo actualizado: LOWER()</h2>
    <p>Ahora usamos <code>LOWER()</code> en lugar de <code>COLLATE</code>:</p>
    <ul>
        <li>âœ… MÃ¡s portable (funciona en Windows, Linux, hosting)</li>
        <li>âœ… No depende de configuraciones del servidor</li>
        <li>âœ… Garantiza coincidencia case-insensitive 100%</li>
        <li>âœ… Compatible con todas las versiones de MySQL/MariaDB</li>
    </ul>

    <hr style="margin: 30px 0;">
    <p><a href="public/?r=catalog">â† Volver al catÃ¡logo</a></p>
</body>
</html>
